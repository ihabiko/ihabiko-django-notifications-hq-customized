{% load static %}
{% load notifications_tags %}

<!-- Nav Item - Alerts -->
<li class="nav-item dropdown no-arrow mx-1">
    <a class="nav-link dropdown-toggle" href="#" id="alertsDropdown" role="button" data-toggle="dropdown"
       aria-haspopup="true" aria-expanded="false">
        <i class="fas fa-bell fa-fw"></i>

        <span class="badge badge-danger badge-counter live_notify_badge"></span>
    </a>
    <!-- Dropdown - Alerts -->
    <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
         aria-labelledby="alertsDropdown">
        <h6 class="dropdown-header">
            Notifications
        </h6>
        <span class="live_notify_list">
        </span>
    </div>
</li>
{% block extrascripts %}
    <script src="{% static 'notifications/notify.js' %}" type="text/javascript"></script>
    <script>
        function my_special_notification_callback(data) {
            $(".live_notify_list").empty();
            for (var i = 0; i < data.all_list.length; i++) {
                var notice = data.all_list[i];
                var notice_item = $('<a></a>');
                if (notice.unread)
                    notice_item.attr("class", "dropdown-item d-flex align-items-center bg-dark");
                else
                    notice_item.attr("class", "dropdown-item d-flex align-items-center bg-gray");

                notice_item.attr("href", notice.verb);
                {#notice_item.attr("href", '/notifications/mark-as-read/' + notice.slug);#}

                var notice_description = $('<span></span>');
                if (notice.unread)
                    notice_description.attr("class", "font-weight-bold text-white ");


                notice_description.text(notice.description);
                var notice_content = $('<div></div>').append(notice_description);
                notice_item.append(notice_content);
                $(".live_notify_list").append(notice_item);

            }
            if (data.all_list.length === 0) {
                $(".live_notify_list").text('no notification to show');
            }
        }
    </script>
    {% register_notify_callbacks callbacks='fill_notification_badge,my_special_notification_callback' %}


{% endblock %}